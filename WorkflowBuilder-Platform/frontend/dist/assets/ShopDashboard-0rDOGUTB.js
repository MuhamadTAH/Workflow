import{u as V,r,t as P,j as e,N as q,s as N,S as I,F as R,a as v,b as W,c as y,d as S,e as C,f as Y,g as z}from"./index-BXAzR72f.js";function _(){const w=V(),[t,h]=r.useState(null),[M,g]=r.useState(!0),[k,p]=r.useState(!1),[F,m]=r.useState(!1),[a,b]=r.useState({shopName:"",displayName:"",description:"",contactMethod:"whatsapp",contactValue:""}),[i,d]=r.useState(!1),[u,l]=r.useState(""),[f,n]=r.useState("");if(!P.isLoggedIn())return e.jsx(q,{to:"/login"});r.useEffect(()=>{x()},[]);const x=async()=>{console.log("Loading shop data...");try{const s=await N.getMyShop();console.log("Shop API response:",s),h(s.data.shop),s.data.shop&&b({shopName:s.data.shop.shopName,displayName:s.data.shop.displayName,description:s.data.shop.description||"",contactMethod:s.data.shop.contactMethod,contactValue:s.data.shop.contactValue})}catch(s){console.error("Error loading shop:",s),l("Unable to connect to backend. Please check if the server is running."),h(null)}finally{console.log("Setting loading to false"),g(!1)}},c=s=>{b({...a,[s.target.name]:s.target.value})},U=async s=>{s.preventDefault(),d(!0),l("");try{const o=await N.createShop(a);h(o.data.shop),p(!1),n("Shop created successfully!"),setTimeout(()=>n(""),3e3)}catch(o){console.error("Shop creation error:",o);const A=o.response?.data?.message||o.response?.statusText||o.message||"Failed to create shop";l(`Error: ${A}`)}finally{d(!1)}},E=async s=>{s.preventDefault(),d(!0),l("");try{const o={displayName:a.displayName,description:a.description,contactMethod:a.contactMethod,contactValue:a.contactValue};await N.updateShop(t.id,o),await x(),m(!1),n("Shop updated successfully!"),setTimeout(()=>n(""),3e3)}catch(o){l(o.response?.data?.message||"Failed to update shop")}finally{d(!1)}},L=()=>{t?.shopUrl&&(navigator.clipboard.writeText(t.shopUrl),n("Shop URL copied to clipboard!"),setTimeout(()=>n(""),3e3))},D=s=>{switch(s){case"whatsapp":return e.jsx(z,{className:"contact-icon whatsapp"});case"telegram":return e.jsx(Y,{className:"contact-icon telegram"});case"email":return e.jsx(C,{className:"contact-icon email"});default:return e.jsx(C,{className:"contact-icon"})}},j=s=>{switch(s){case"whatsapp":return"WhatsApp Number";case"telegram":return"Telegram Username";case"email":return"Email Address";default:return"Contact"}},T=s=>{switch(s){case"whatsapp":return"+1234567890";case"telegram":return"@username";case"email":return"contact@example.com";default:return""}};return M?e.jsxs("div",{className:"loading",children:[e.jsx("div",{children:"Loading your shop..."}),e.jsx("div",{style:{marginTop:"1rem",fontSize:"0.9rem",color:"#6b7280"},children:"If this takes too long, the backend might be starting up..."})]}):e.jsx(I,{title:"My Shop",subtitle:"Manage your online store and products",children:e.jsxs("div",{children:[u&&e.jsxs("div",{className:"error-message",children:[u,u.includes("Unable to connect")&&e.jsx("button",{className:"btn btn-secondary",onClick:()=>{l(""),g(!0),x()},style:{marginLeft:"1rem",padding:"0.5rem 1rem"},children:"Try Again"})]}),f&&e.jsx("div",{className:"success-message",children:f}),t?e.jsxs("div",{className:"shop-overview",children:[e.jsxs("div",{className:"shop-info-card",children:[e.jsxs("div",{className:"shop-info-header",children:[e.jsxs("div",{className:"shop-info-main",children:[e.jsx("h2",{className:"shop-name",children:t.displayName}),e.jsxs("p",{className:"shop-url",children:[e.jsx("strong",{children:"Shop URL:"}),e.jsx("span",{className:"url-text",children:t.shopUrl}),e.jsx("button",{className:"copy-btn",onClick:L,title:"Copy URL",children:e.jsx(W,{})})]}),t.description&&e.jsx("p",{className:"shop-description",children:t.description})]}),e.jsxs("div",{className:"shop-info-actions",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>m(!0),children:[e.jsx(y,{})," Edit Shop"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>n("Public shop page coming next! Your URL will be: "+t.shopUrl+" (Development Mode)"),children:[e.jsx(S,{})," View Shop"]})]})]}),e.jsxs("div",{className:"shop-stats",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-number",children:t.productCount}),e.jsx("div",{className:"stat-label",children:"Products"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:D(t.contactMethod)}),e.jsx("div",{className:"stat-label",children:j(t.contactMethod)}),e.jsx("div",{className:"stat-value",children:t.contactValue})]})]})]}),F&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h3",{children:"Edit Shop Information"}),e.jsxs("form",{onSubmit:E,className:"shop-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Display Name*"}),e.jsx("input",{type:"text",name:"displayName",value:a.displayName,onChange:c,required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{name:"description",value:a.description,onChange:c,className:"form-textarea",rows:"3"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Contact Method*"}),e.jsxs("select",{name:"contactMethod",value:a.contactMethod,onChange:c,className:"form-select",required:!0,children:[e.jsx("option",{value:"whatsapp",children:"WhatsApp"}),e.jsx("option",{value:"telegram",children:"Telegram"}),e.jsx("option",{value:"email",children:"Email"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[j(a.contactMethod),"*"]}),e.jsx("input",{type:"text",name:"contactValue",value:a.contactValue,onChange:c,required:!0,className:"form-input"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>m(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:i,children:i?"Updating...":"Update Shop"})]})]})]})}),e.jsxs("div",{className:"quick-actions",children:[e.jsx("h3",{children:"Quick Actions"}),e.jsxs("div",{className:"action-buttons",children:[e.jsxs("button",{className:"action-btn",onClick:()=>w("/shop/add-product"),children:[e.jsx(v,{}),e.jsx("span",{children:"Add Product"})]}),e.jsxs("button",{className:"action-btn",onClick:()=>n("Product Management feature coming next! (Development Mode)"),children:[e.jsx(y,{}),e.jsx("span",{children:"Manage Products"})]}),e.jsxs("button",{className:"action-btn",onClick:()=>n("Analytics feature coming soon! (Development Mode)"),children:[e.jsx(S,{}),e.jsx("span",{children:"View Analytics"})]})]})]})]}):e.jsx("div",{className:"no-shop-container",children:e.jsxs("div",{className:"no-shop-card",children:[e.jsx(R,{className:"no-shop-icon"}),e.jsx("h2",{children:"Create Your Shop"}),e.jsx("p",{children:"You don't have a shop yet. Create one to start selling your products!"}),k?e.jsxs("form",{onSubmit:U,className:"shop-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Shop Name (URL)*"}),e.jsx("input",{type:"text",name:"shopName",value:a.shopName,onChange:c,placeholder:"myshop (letters, numbers, -, _ only)",required:!0,className:"form-input"}),e.jsxs("small",{children:["This will be your shop URL: yourdomain.com/shop/",a.shopName]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Display Name*"}),e.jsx("input",{type:"text",name:"displayName",value:a.displayName,onChange:c,placeholder:"My Awesome Shop",required:!0,className:"form-input"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{name:"description",value:a.description,onChange:c,placeholder:"Tell customers about your shop...",className:"form-textarea",rows:"3"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Contact Method*"}),e.jsxs("select",{name:"contactMethod",value:a.contactMethod,onChange:c,className:"form-select",required:!0,children:[e.jsx("option",{value:"whatsapp",children:"WhatsApp"}),e.jsx("option",{value:"telegram",children:"Telegram"}),e.jsx("option",{value:"email",children:"Email"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[j(a.contactMethod),"*"]}),e.jsx("input",{type:"text",name:"contactValue",value:a.contactValue,onChange:c,placeholder:T(a.contactMethod),required:!0,className:"form-input"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>p(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:i,children:i?"Creating...":"Create Shop"})]})]}):e.jsxs("button",{className:"btn btn-primary",onClick:()=>p(!0),children:[e.jsx(v,{})," Create My Shop"]})]})})]})})}export{_ as default};
